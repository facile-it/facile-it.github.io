<!DOCTYPE HTML>

<html>
    <head>
        
            
                <title>Code reuse: a primer</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="referrer" content="always">
        <meta name="generator" content="Hugo 0.69.0" />
        


        
        
            
                <meta name="description" content="News, repos, tips &amp; trends from the Facile.it Engineering team!">
            
        

        <meta name="twitter:card" content="summary_large_image"/>

    <meta name="twitter:image" content="https://engineering.facile.it/images/social/social-preview.png"/>



<meta name="twitter:title" content="Code reuse: a primer"/>
<meta name="twitter:description" content="Last time we looked at a possible implementation for the Optional type in Objective-C; while the main point was to port to Objective-C a tool that&rsquo;s frequently used in Swift, making use of the Optional class can be considered an application of a much more general concept: code reuse. In fact, Optional is not tied to a particular domain, and can be reused over and over again in multiple projects: that&rsquo;s what actually happens in Swift."/>

    
        <meta name="twitter:creator" content="@_logicist"/>
    


<meta name="twitter:site" content="@FacileIt_Engr"/>


        <meta property="og:title" content="Code reuse: a primer" />
<meta property="og:description" content="Last time we looked at a possible implementation for the Optional type in Objective-C; while the main point was to port to Objective-C a tool that&rsquo;s frequently used in Swift, making use of the Optional class can be considered an application of a much more general concept: code reuse. In fact, Optional is not tied to a particular domain, and can be reused over and over again in multiple projects: that&rsquo;s what actually happens in Swift." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://engineering.facile.it/blog/eng/code-reuse-a-primer/" />
<meta property="article:published_time" content="2015-12-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-12-09T00:00:00+00:00" />


        
            
                
                <meta property="og:image" content="https://engineering.facile.it/images/social/social-preview.png">
                
            
        

        <meta itemprop="name" content="Code reuse: a primer">
<meta itemprop="description" content="Last time we looked at a possible implementation for the Optional type in Objective-C; while the main point was to port to Objective-C a tool that&rsquo;s frequently used in Swift, making use of the Optional class can be considered an application of a much more general concept: code reuse. In fact, Optional is not tied to a particular domain, and can be reused over and over again in multiple projects: that&rsquo;s what actually happens in Swift.">
<meta itemprop="datePublished" content="2015-12-09T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2015-12-09T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1827">



<meta itemprop="keywords" content="" />
        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/additional.css">
            <link rel="stylesheet" href="/css/add-on.css">
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/monokai-sublime.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-22342495-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="/">Facile.it Engineering</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/categories/">
                            <i class="fa fa-folder-open-o">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="/authors/">
                            <i class="fa fa-pencil">&nbsp;</i>Authors
                    </a>
                </li>
            
                <li>
                    <a href="/ita/careers/">
                            <i class="fa fa-briefcase">&nbsp;</i>Careers
                    </a>
                </li>
            
                <li>
                    <a href="/eng/who-we-are/">
                            <i class="fa fa-users">&nbsp;</i>Who we are
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="https://engineering.facile.it">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="https://engineering.facile.it">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/categories/">
                            <h3>
                                <i class="fa fa-folder-open-o">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/authors/">
                            <h3>
                                <i class="fa fa-pencil">&nbsp;</i>Authors
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/ita/careers/">
                            <h3>
                                <i class="fa fa-briefcase">&nbsp;</i>Careers
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/eng/who-we-are/">
                            <h3>
                                <i class="fa fa-users">&nbsp;</i>Who we are
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section id="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/eng/v-protetto13-10-2023/">Venerdì Protetto | October edition</a></h3>
                                
                                <time class="published" datetime=
                                    '2023-10-18'>
                                    October 18, 2023</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/eng/nest-js-graceful-shutdown/">NestJS graceful shutdown for RabbitMQ Microservices</a></h3>
                                
                                <time class="published" datetime=
                                    '2023-10-14'>
                                    October 14, 2023</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/eng/v-protetto8-9-2023/">Venerdì Protetto | September edition: Code shipping, Community tools, Quix Streams Library</a></h3>
                                
                                <time class="published" datetime=
                                    '2023-09-18'>
                                    September 18, 2023</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            


<li>
  <a href="//twitter.com/share?url=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f&amp;text=Code%20reuse%3a%20a%20primer&amp;via=FacileIt_Engr" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>


<li>
  <a href="//plus.google.com/share?url=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
  </a>
</li>


<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>


<li>
  <a href="//reddit.com/submit?url=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f&amp;title=Code%20reuse%3a%20a%20primer" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>


<li>
  <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f&amp;title=Code%20reuse%3a%20a%20primer" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>


<li>
  <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f&amp;title=Code%20reuse%3a%20a%20primer" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>


<li>
  <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f&amp;description=Code%20reuse%3a%20a%20primer" target="_blank" class="share-btn pinterest">
    <i class="fa fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>


<li>
  <a href="mailto:?subject=Check out this post by &amp;body=https%3a%2f%2fengineering.facile.it%2fblog%2feng%2fcode-reuse-a-primer%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>

        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="/blog/eng/code-reuse-a-primer/">Code reuse: a primer</a></h1>
            
        
        
        
            <p class="translated-article">
                Questo articolo è disponibile anche
                <a href="/blog/ita/codice-riusabile-un-primer/">in italiano</a>
            </p>
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2015-12-09'>
            9 December 2015
        </time>

        
            <a href="/authors/elviro/" class="author">
            
                <span class="name">Elviro Rocca</span>
                <img src="https://www.gravatar.com/avatar/fb2983ff4983323312496f2b67e26186?d=404&amp;s=250" alt="Elviro Rocca avatar" />
            
            </a>
        

        
            <p>9 minute read</p>
        
    </div>
</header>


  


  

  <div id="content">
    <p><a href="http://engineering.facile.it/optionals-in-objective-c/">Last time</a> we looked at a possible implementation for the <a href="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID330">Optional</a> type in Objective-C; while the main point was to port to Objective-C a tool that&rsquo;s frequently used in Swift, making use of the <code>Optional</code> class can be considered an application of a much more general concept: <strong>code reuse</strong>. In fact, <code>Optional</code> is not tied to a particular domain, and can be reused over and over again in multiple projects: that&rsquo;s what actually happens in Swift. But, to think about it, that&rsquo;s what happens for a wide range of <em>classes</em> in Objective-C, or <em>types</em> in Swift: for example, <code>NSArray</code> and <code>Array</code> are both constructs that expose a certain interface, have a certain implementation, and are reused multiple times within methods and functions. And again, <code>NSArray</code> and <code>Array</code> are not tied to a particular domain, and have two important properties:</p>
<ul>
<li>they are <strong>generic</strong>, that is, they are not dependent on a particular subtype: an array of numbers and an array of strings will work in the exact same way when it comes to behavior that&rsquo;s strictly associated to arrays, like counting elements, removing or adding an element, mapping, filtering, reducing et cetera;</li>
<li>they are <strong>composable</strong>, that is, they can be stacked on top of each other, and assembled with other more specific things, while keeping the same <strong>predictable behavior</strong>: an array of <em>customers</em>, each with their own array of <em>purchased products</em>, can be mapped to an array of arrays of <em>products</em>, that can be flattened into an array of <em>products</em>, that can be reduced into a number representing the total cost;</li>
</ul>
<p><code>Array</code>, like <code>Optional</code>, is a nice example of perfectly reusable code, but there are many more constructs that satisfy the aforementioned rules: <em>genericity</em> and <em>composability</em>. What doesn&rsquo;t satisfy the rules is domain-specific objects, even when it seems like an object is sufficiently generic to be reused. A <code>Customer</code> class, for example, could seem a good candidate, but trying to reuse the same class in two different projects will result in <strong>bad news</strong> and headaches: either we&rsquo;ll need to <strong>specialize</strong> the class for each project, making the two diverge, or we&rsquo;ll need to add levels of <strong>indirection</strong>, because we&rsquo;re forcing an object into a project it doesn&rsquo;t belong to.</p>
<p>There&rsquo;s another thing to consider: if we really want to reuse code, we&rsquo;ll also need to make <strong>design choices</strong> that allow that code to be reused. I could actually forget about the <code>Array</code> and <code>Optional</code> types, and create classes that never expose their underlying components; for example, I could create a class that represents a collection of optional objects, without ever exposing in the interface the fact that I&rsquo;m using <code>Array</code> and <code>Optional</code> for its implementation: it would result in some serious <strong>contortion</strong> of methods&rsquo; signature, but it&rsquo;s possible. Also, is it a good idea? <strong>I don&rsquo;t think so</strong>. Creating a specific, incomposable class for every possible need will result in thousands of lines of what&rsquo;s essentially <strong>boilerplate</strong> code, complicated interfaces, and ridiculously long class names. If we aspire to code reuse, other than the two rules we just defined, we also need to pay attention to the way we architect our apps, and the main design principle to follow here is one of <strong>composition</strong>, that can be summed up with the following:</p>
<blockquote>
<p>Domain-specific constructs and behaviors should be realized by composing atomic and generic building blocks.</p>
</blockquote>
<p>This basically means that, instead of creating every time a specific implementation for our needs, we should try and satisfy that need by composing reusable, atomic objects. This looks complex, and at this point we should ask ourselves if code reuse is really something we want to pursue. My answer is a definitive <strong>yes</strong>, for the following reasons:</p>
<ul>
<li>with reusable components we can <strong>encapsulate</strong> a particular behavior, and avoid rewriting essentially the same thing over and over again;</li>
<li>we&rsquo;ll have a <strong>guideline</strong> for designing the architecture of our app, because we wont&rsquo;t need to constantly define new interfaces for the same behaviors;</li>
<li>a reusable component is very easy to <strong>test</strong>, because it&rsquo;s small and atomic, so by using it we will be more confident about the correctness of our code;</li>
</ul>
<p>That, again, is what happens when we use types like <code>Array</code> and <code>Optional</code>. As I said, there are many more of these building blocks, and actually the definition of their interfaces is a problem in itself, and has no obvious solution, but I think it&rsquo;s a very interesting problem to tackle. By following the <em>generic</em> and <em>composable</em> rules we already have a guideline for designing them, but if we want to create our owns we should probably add one more rule:</p>
<ul>
<li>a reusable object has to be <strong>simple</strong>, that is, it should have a unique, linear, easily describable responsibility;</li>
</ul>
<p><code>Optional</code> follows this rule: it&rsquo;s a generic container that represents an object that could be there, or not. <code>Array</code> follows this rule: it represents and <em>ordered</em> collection of objects, each one them accessible in constant time. Let&rsquo;s try to apply the rule and create a new reusable object.</p>
<p>Consider this real, kind of frequent use case: different objects must be notified when a certain object changes state or does something. A way to solve the problem is represented by the <a href="https://en.wikipedia.org/wiki/Observer_pattern">observer pattern</a>, that is, make our objects implement an interface that exposes a <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">publish-subscribe</a> behavior. The point is, implementing an interface <strong>is not reusable</strong>: each time we want to use this pattern we are going to <strong>rewrite</strong> very similar code; instead, we want to encapsulate the behavior in a generic object, and reuse that object instead. What follows is a possible implementation, the one that I use in production, but there are many more: actually, <a href="https://en.wikipedia.org/wiki/Functional_reactive_programming">functional reactive programming</a> has spawned from this very problem, that is, finding a generic, composable way of representing and manipulating observable streams, but in this case we&rsquo;re going to create a much simpler <strong>Signal</strong> object.</p>
<p>The <code>Signal</code> class we want to implement is going to represent an <em>update</em> for a certain object: that update can be everything, like a new value for a property, or an action that was taken. We&rsquo;ll use the Swift language, which is also going to give us a lot of <strong>type-safety</strong> for free. Here&rsquo;s a summary of what we want for the <code>Signal</code> class:</p>
<ul>
<li>it has to a have a <strong>parametric</strong> subtype, that is, the type of the value that will be signaled in each update;</li>
<li>it has to have an <code>observe</code> method, that takes a closure representing an action that has to be taken every time an update is given;</li>
<li>it has to have a <code>send</code> method, which takes a new value of the underlying subtype;</li>
<li>it has to have some simple methods for composition, that follow the usual naming conventions, like <code>map</code>, for generating a new <code>Signal</code> from an existing one by transforming the observed value, and <code>forwardTo</code> to make another <code>Signal</code> <em>trigger</em> when a certain <code>Signal</code> is producing a new value;</li>
</ul>
<p>Semantically, we can describe a <code>Signal</code> as a container for a value that&rsquo;s going to be there at a certain point in time, and it&rsquo;s going to update itself indefinitely.</p>
<p>What follows is the entire implementation of the <code>Signal</code> class:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">SignalContinuation</span>
{
  <span style="color:#66d9ef">case</span> Continue
  <span style="color:#66d9ef">case</span> Stop
}

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Signal</span>&lt;Subtype&gt;
{
  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> observers: [(Subtype -&gt; SignalContinuation)] = []

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">init</span>() {}

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">observe</span> (observeFunction: Subtype -&gt; SignalContinuation)
  {
    observers.append(observeFunction)
  }

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">send</span> (value: Subtype)
  {
    <span style="color:#66d9ef">var</span> continuations: [(Subtype -&gt; SignalContinuation)] = []
    <span style="color:#66d9ef">while</span> observers.count <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
    {
      <span style="color:#66d9ef">let</span> observer = observers.removeFirst()
      <span style="color:#66d9ef">let</span> continuation = observer(value)
      <span style="color:#66d9ef">switch</span> continuation
      {
      <span style="color:#66d9ef">case</span> .Continue:
        continuations.append(observer)
      <span style="color:#66d9ef">case</span> .Stop: <span style="color:#66d9ef">break</span>
      }
    }
    observers = continuations
  }

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">forwardTo</span> (otherSignal: Signal&lt;Subtype&gt;) -&gt; Signal
  {
    observe { action <span style="color:#66d9ef">in</span>
      otherSignal.send(action)
      <span style="color:#66d9ef">return</span> .Continue
    }
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">self</span>
  }

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">forwardTo</span> &lt;OtherSubtype&gt; (
    otherSignal: Signal&lt;OtherSubtype&gt;,
    mappingFunction: Subtype -&gt; OtherSubtype) -&gt; Signal
  {
    observe { action <span style="color:#66d9ef">in</span>
      otherSignal.send(mappingFunction(action))
      <span style="color:#66d9ef">return</span> .Continue
    }
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">self</span>
  }

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">map</span> &lt;OtherSubtype&gt; (transform: Subtype -&gt; OtherSubtype) -&gt; Signal&lt;OtherSubtype&gt;
  {
    <span style="color:#66d9ef">let</span> mappedSignal = Signal&lt;OtherSubtype&gt;()
    forwardTo(mappedSignal, mappingFunction: transform)
    <span style="color:#66d9ef">return</span> mappedSignal
  }
}
</code></pre></div><p>This is really simple, but still, really powerful. A problem that&rsquo;s frequently found when implementing the observer pattern is how to manage unsubscriptions; it&rsquo;s a responsibility of the observer object to stop observing something, and in this <code>Signal</code> implementation this is easily managed within the closure passed to the <code>observe</code> method: the closure must return a <code>SignalContinuation</code> value, that can be simply <code>.Continue</code> (that is, keep observing updates) or <code>.Stop</code>. Another problem is memory management: we need to make sure that when an observer&rsquo;s memory is released, it will also stop observing, or a message will be sent to a dangling pointer, resulting in the app crashing. Swift&rsquo;s <code>weak</code> memory semantics actually makes this really easy to do: we&rsquo;ll put a <code>guard</code> clause at the beginning of the closure passed to the <code>observe</code> method; if the object has become <code>nil</code>, we&rsquo;ll simply return <code>.Stop</code>. The following example shows a simple use of the <code>Signal</code> class, including the <em>stop-observing-on-nil</em> mechanism:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Sender</span>
{
  <span style="color:#66d9ef">let</span> signal = Signal&lt;Int&gt;()

  <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">sendNew</span>(value: Int)
  {
    signal.send(value)
  }
}

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Receiver</span>&lt;<span style="color:#66d9ef">Type</span>: CustomStringConvertible&gt;
{
  <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">startObserving</span>(signal: Signal&lt;<span style="color:#66d9ef">Type</span>&gt;)
  {
    signal.observe { [<span style="color:#66d9ef">weak</span> <span style="color:#66d9ef">self</span>] value <span style="color:#66d9ef">in</span>
      <span style="color:#66d9ef">guard</span> <span style="color:#66d9ef">let</span> this = <span style="color:#66d9ef">self</span> <span style="color:#66d9ef">else</span> { <span style="color:#66d9ef">return</span> .Stop }
      this.printNewValue(value)
      <span style="color:#66d9ef">return</span> .Continue
    }
  }

  <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">printNewValue</span>(value: <span style="color:#66d9ef">Type</span>)
  {
    print(value)
  }
}

<span style="color:#66d9ef">let</span> sender = Sender()
<span style="color:#66d9ef">let</span> receiver = Receiver&lt;Int&gt;()

receiver.startObserving(sender.signal)

sender.signal.send(<span style="color:#ae81ff">3</span>)
sender.signal.send(<span style="color:#ae81ff">5</span>)
sender.signal.send(<span style="color:#ae81ff">10</span>)
sender.signal.send(<span style="color:#ae81ff">20</span>)
<span style="color:#75715e">/// this will print 3, 5, 10, 20 on console</span>
</code></pre></div><p>In the example we can see an application of the concepts we talked about at the beginning of this article: instead of creating yet another interface for the same behavior, we are directly using and reusing the <code>Signal</code> object. A more complex example would be the addition of something like a <em>resonator</em>, that is, an object with a <code>Signal</code> that resonates with another, like in the following example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DoublingResonator</span>
{
  <span style="color:#66d9ef">let</span> signal = Signal&lt;Int&gt;()

  <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">resonateWith</span>(otherSignal: Signal&lt;Int&gt;)
  {
    otherSignal.forwardTo(signal) { $0<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> }
  }
}

<span style="color:#66d9ef">let</span> resonator = DoublingResonator()
resonator.resonateWith(sender.signal)

<span style="color:#66d9ef">let</span> receiver = Receiver&lt;Int&gt;()

receiver.startObserving(resonator.signal)

sender.signal.send(<span style="color:#ae81ff">3</span>)
sender.signal.send(<span style="color:#ae81ff">5</span>)
sender.signal.send(<span style="color:#ae81ff">10</span>)
sender.signal.send(<span style="color:#ae81ff">20</span>)
<span style="color:#75715e">/// this will print 6, 10, 20, 40 on console</span>
</code></pre></div><p>There are many other options for composition of signals, but as long as we don&rsquo;t need them, it&rsquo;s better to keep the class <strong>simple</strong>: then, gradually over time, we can start adding features to the class, and as long as they&rsquo;re properly generic and tested, we will be able to use them in all of our projects.</p>
<p>To conclude, finding the right abstractions for reusability is of course a problem, and the solution is not an easy one: plenty of academic papers address the problem in several ways (classic Charles W. Krueger&rsquo;s paper <a href="http://www.biglever.com/papers/Krueger_AcmReuseSurvey.pdf">Software Reuse</a> contains a good overview of the used techniques), and the reason why <a href="https://en.wikipedia.org/wiki/Category_theory">category theory</a> has many applications in functional programming is because it offers an excellent set of abstractions for tackling several classes of problems. But still, I think the advantages of code reuse are many, and that achieving a compositional design through atomic, reusable components is <strong>a worthy goal</strong> to pursue.</p>

  </div>

  

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/english">English</a></li>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/swift">Swift</a></li>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/functional-programming">Functional programming</a></li>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/code-reuse">Code reuse</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "facile-it" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="/blog/ita/codice-riusabile-un-primer/"
                class="button big previous">Codice riusabile: un primer</a></li>
    

    
        <li><a href="/blog/ita/puli-universal-packages-for-php/"
                class="button big next">Puli: Universal Packages for PHP</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='/'><img src="/images/logo_engineering.png" width="100%" alt="Facile.it Engineering" /></a>
      
    
    
      <header>
        <h2></h2>
        <p>News, repos, tips & trends from the Facile.it Engineering team!</p>
      </header>
    
    
      <ul class="icons">
        
          <li>
            <a href="" type="application/rss+xml" target="_blank" title="RSS" class="fa fa-rss"></a>
          </li>
        
        
  <li><a href="//github.com/facile-it" target="_blank" title="GitHub" class="fa fa-github"></a></li>



























  <li><a href="//linkedin.com/company/facile-it" target="_blank" title="LinkedIn Company" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/facile.it" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>









  <li><a href="//youtube.com/user/Facileit" target="_blank" title="YouTube" class="fa fa-youtube"></a></li>













  <li><a href="//instagram.com/facile.it" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>





  <li><a href="//twitter.com/FacileIt_Engr" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
  </section>

  
  <section id="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <div class="author-avatars">
                
                  
                    <a href="/authors/engineering/" class="author" title="See other posts from Facile.it engineers">
                      <img src="https://avatars1.githubusercontent.com/u/8501934?v=3&amp;s=200" alt="Facile.it engineers avatar" class="author-avatar"/>
                    </a>
                  
                
              </div>

              <h3>
                <a href="/blog/eng/v-protetto13-10-2023/">Venerdì Protetto | October edition</a>
              </h3>
              
              <time class="published" datetime='2023-10-18'>
                18 October 2023
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <div class="author-avatars">
                
                  
                    <a href="/authors/pasqualino-desimone/" class="author" title="See other posts from Pasqualino de Simone">
                      <img src="https://www.gravatar.com/avatar/3b8e327984accc34cafb36d1acd6284dfcc72478f5b914750caf40feab5f7acd" alt="Pasqualino de Simone avatar" class="author-avatar"/>
                    </a>
                  
                
              </div>

              <h3>
                <a href="/blog/eng/nest-js-graceful-shutdown/">NestJS graceful shutdown for RabbitMQ Microservices</a>
              </h3>
              
              <time class="published" datetime='2023-10-14'>
                14 October 2023
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <div class="author-avatars">
                
                  
                    <a href="/authors/engineering/" class="author" title="See other posts from Facile.it engineers">
                      <img src="https://avatars1.githubusercontent.com/u/8501934?v=3&amp;s=200" alt="Facile.it engineers avatar" class="author-avatar"/>
                    </a>
                  
                
              </div>

              <h3>
                <a href="/blog/eng/v-protetto8-9-2023/">Venerdì Protetto | September edition: Code shipping, Community tools, Quix Streams Library</a>
              </h3>
              
              <time class="published" datetime='2023-09-18'>
                18 September 2023
              </time>
            </header>
            

          </article>
        
      </div>

      
        <a href=
          
            /blog/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="/categories/">Top categories</a></h3>
      </header>
        
          
        

        
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/conferences/">Conferences</a>
                <span style="float:right;">10</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/docker/">Docker</a>
                <span style="float:right;">6</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/english/">English</a>
                <span style="float:right;">41</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/functional-programming/">Functional programming</a>
                <span style="float:right;">11</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/italiano/">Italiano</a>
                <span style="float:right;">34</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/oop/">OOP</a>
                <span style="float:right;">6</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/open-source/">Open source</a>
                <span style="float:right;">7</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/php/">PHP</a>
                <span style="float:right;">23</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/protected-fridays/">Protected Fridays</a>
                <span style="float:right;">7</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/software-testing/">Software Testing</a>
                <span style="float:right;">7</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/swift/">Swift</a>
                <span style="float:right;">8</span>
              
            </header>
          </article>
        </p>
        
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/symfony/">Symfony</a>
                <span style="float:right;">5</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
        <p>
            <a href="/categories/" class="button">View more categories</a>
        </p>
    </section>
  
  

  
  
    <section id="mini-bio">
      <h3>About</h1>
      <p>Facile.it relies on a big and keen crew of developers. Since 2008, the group’s projects are based on PHP, and as time goes by new technologies become part of corporate know how. This blog allows our developers to share tips and direct experiences with new technologies.</p>
      <a href="/ita/chi-siamo/" class="button">Learn More</a>
    </section>
  

  
  <section id="footer">
    
      <ul class="icons">
        
          <li>
            <a href="" type="application/rss+xml" target="_blank" title="RSS" class="fa fa-rss"></a>
          </li>
        
        
  <li><a href="//github.com/facile-it" target="_blank" title="GitHub" class="fa fa-github"></a></li>



























  <li><a href="//linkedin.com/company/facile-it" target="_blank" title="LinkedIn Company" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/facile.it" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>









  <li><a href="//youtube.com/user/Facileit" target="_blank" title="YouTube" class="fa fa-youtube"></a></li>













  <li><a href="//instagram.com/facile.it" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>





  <li><a href="//twitter.com/FacileIt_Engr" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
    <p class="copyright">
      
        &copy; 2023
        
          Facile.it Engineering
        
      .
      <a href="/ita/disclaimer/" rel="nofollow">Disclaimer</a><br>
      Design <a href="http://html5up.net" rel="nofollow" target="_blank">HTML5 UP</a><br>
      Ported by <a href="//github.com/jpescador" rel="nofollow" target="_blank">Julio Pescador</a><br>
      Modified by <a href="//github.com/Jean85" rel="nofollow" target="_blank">Alessandro Lai</a><br>
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/dockerfile.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/kotlin.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/objectivec.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/python.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/swift.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
      <script src="/js/backToTop.js"></script>
      <script type="text/javascript" src="/js/jquery-lazy/jquery.lazy.min.js"></script>
    

    

    
    <script>hljs.initHighlightingOnLoad();</script>
    <script type="text/javascript">
        $(function() {
            $('.lazy').Lazy();
        });
    </script>
  </body>
</html>

