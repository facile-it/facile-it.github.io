<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/engineering.facile.it\/"
        },
        "articleSection" : "blog",
        "name" : "Swift testing avanzato: stubbing e test asincroni",
        "headline" : "Swift testing avanzato: stubbing e test asincroni",
        "description" : "\u003cp\u003e\u003ca href=\u0022http:\/\/engineering.facile.it\/xcode-testing-in-pratica\/\u0022\u003eIn un precedente articolo\u003c\/a\u003e abbiamo visto le impostazioni di base in Xcode per la scrittura dei \u003cstrong\u003etest unitari\u003c\/strong\u003e: abbiamo evidenziato inoltre \u003cstrong\u003el\u0026rsquo;importanza e l\u0026rsquo;utilità intrinseca dei test\u003c\/strong\u003e, attraverso un semplice esempio riguardante un caso d\u0026rsquo;uso tipico. Nel presente articolo vedremo alcune tecniche un po\u0026rsquo; più avanzate:\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003eimplementeremo uno \u003cstrong\u003eStub Object\u003c\/strong\u003e in Swift;\u003c\/li\u003e\n\u003cli\u003eanalizzeremo un altro caso di test \u003cem\u003easincrono\u003c\/em\u003e;\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003ch2 id=\u0022lo-stub-object\u0022\u003eLo \u003cem\u003eStub Object\u003c\/em\u003e\u003c\/h2\u003e\n\u003cp\u003eUno \u003cem\u003eStub Object\u003c\/em\u003e (per il resto dell\u0026rsquo;articolo, \u003cem\u003estub\u003c\/em\u003e) rappresenta un\u0026rsquo;istanza di una certa classe, la quale \u003cem\u003emima\u003c\/em\u003e una vera classe presente nella nostra \u003cem\u003ecode base\u003c\/em\u003e:  l\u0026rsquo;istanza si comporta esattamente come una equivalente istanza della classe mimata, tranne alcune differenze, ad esempio \u003cstrong\u003ealcuni metodi possono essere sovrascritti\u003c\/strong\u003e per poter fornire \u003cstrong\u003eun determinato output\u003c\/strong\u003e utile per i test. Nell\u0026rsquo;implementare uno \u003cem\u003estub\u003c\/em\u003e non è generalmente consentito modificare dettagli di logica interni relativi alla classe che stiamo mimando, ma \u003cstrong\u003eè possibile sovrascrivere metodi pubblici\u003c\/strong\u003e, in modo che essi ritornino i valori che vogliamo, oppure che svolgano una particolare procedura necessaria per i test. Tanto per fare un esempio pratico potremmo \u003cem\u003estubbare\u003c\/em\u003e una classe che ci fornisce la data precisa in un certo istante, in modo da ottenere una data diversa da usare nei test, oppure un client che chiede a un server delle informazioni su un utente, in modo da far ritonare al client \u003cem\u003estub\u003c\/em\u003e delle informazioni arbitrarie.\u003c\/p\u003e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2015",
        "datePublished": "2015-06-05 00:00:00 \u002b0000 UTC",
        "dateModified" : "2015-06-05 00:00:00 \u002b0000 UTC",
        "url" : "https:\/\/engineering.facile.it\/blog\/ita\/swift-testing-avanzato-stubbing-e-test-asincroni\/",
        "wordCount" : "1894",
        "keywords" : [ "Blog" ]
    }
    </script>
        
            
                <title>Swift testing avanzato: stubbing e test asincroni</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="referrer" content="always">
        <meta name="generator" content="Hugo 0.134.2">
        


        
        
            
                <meta name="description" content="In un precedente articolo abbiamo visto le impostazioni di base in Xcode per la scrittura dei test unitari: abbiamo evidenziato inoltre l&rsquo;importanza e l&rsquo;utilità intrinseca dei test, attraverso un semplice esempio riguardante un caso d&rsquo;uso tipico. Nel presente articolo vedremo alcune tecniche un po&rsquo; più avanzate:

implementeremo uno Stub Object in Swift;
analizzeremo un altro caso di test asincrono;

Lo Stub Object
Uno Stub Object (per il resto dell&rsquo;articolo, stub) rappresenta un&rsquo;istanza di una certa classe, la quale mima una vera classe presente nella nostra code base:  l&rsquo;istanza si comporta esattamente come una equivalente istanza della classe mimata, tranne alcune differenze, ad esempio alcuni metodi possono essere sovrascritti per poter fornire un determinato output utile per i test. Nell&rsquo;implementare uno stub non è generalmente consentito modificare dettagli di logica interni relativi alla classe che stiamo mimando, ma è possibile sovrascrivere metodi pubblici, in modo che essi ritornino i valori che vogliamo, oppure che svolgano una particolare procedura necessaria per i test. Tanto per fare un esempio pratico potremmo stubbare una classe che ci fornisce la data precisa in un certo istante, in modo da ottenere una data diversa da usare nei test, oppure un client che chiede a un server delle informazioni su un utente, in modo da far ritonare al client stub delle informazioni arbitrarie.">
            
        

        
<meta name="twitter:card" content="summary_large_image"/>

    
        <meta name="twitter:image" content="https://engineering.facile.it/images/social/social-preview.png"/>
        <meta name="og:image" content="https://engineering.facile.it/images/social/social-preview.png"/>
    



<meta name="og:title" content="Swift testing avanzato: stubbing e test asincroni"/>
<meta name="og:description" content="In un precedente articolo abbiamo visto le impostazioni di base in Xcode per la scrittura dei test unitari: abbiamo evidenziato inoltre l&rsquo;importanza e l&rsquo;utilità intrinseca dei test, attraverso un semplice esempio riguardante un caso d&rsquo;uso tipico. Nel presente articolo vedremo alcune tecniche un po&rsquo; più avanzate:

implementeremo uno Stub Object in Swift;
analizzeremo un altro caso di test asincrono;

Lo Stub Object
Uno Stub Object (per il resto dell&rsquo;articolo, stub) rappresenta un&rsquo;istanza di una certa classe, la quale mima una vera classe presente nella nostra code base:  l&rsquo;istanza si comporta esattamente come una equivalente istanza della classe mimata, tranne alcune differenze, ad esempio alcuni metodi possono essere sovrascritti per poter fornire un determinato output utile per i test. Nell&rsquo;implementare uno stub non è generalmente consentito modificare dettagli di logica interni relativi alla classe che stiamo mimando, ma è possibile sovrascrivere metodi pubblici, in modo che essi ritornino i valori che vogliamo, oppure che svolgano una particolare procedura necessaria per i test. Tanto per fare un esempio pratico potremmo stubbare una classe che ci fornisce la data precisa in un certo istante, in modo da ottenere una data diversa da usare nei test, oppure un client che chiede a un server delle informazioni su un utente, in modo da far ritonare al client stub delle informazioni arbitrarie."/>


    
        <meta name="twitter:creator" content="@_logicist"/>
    



    <meta name="twitter:site" content="@FacileIt_Engr"/>



        <meta property="og:url" content="https://engineering.facile.it/blog/ita/swift-testing-avanzato-stubbing-e-test-asincroni/">
  <meta property="og:site_name" content="Facile.it Engineering">
  <meta property="og:title" content="Swift testing avanzato: stubbing e test asincroni">
  <meta property="og:description" content="In un precedente articolo abbiamo visto le impostazioni di base in Xcode per la scrittura dei test unitari: abbiamo evidenziato inoltre l’importanza e l’utilità intrinseca dei test, attraverso un semplice esempio riguardante un caso d’uso tipico. Nel presente articolo vedremo alcune tecniche un po’ più avanzate:
implementeremo uno Stub Object in Swift; analizzeremo un altro caso di test asincrono; Lo Stub Object Uno Stub Object (per il resto dell’articolo, stub) rappresenta un’istanza di una certa classe, la quale mima una vera classe presente nella nostra code base: l’istanza si comporta esattamente come una equivalente istanza della classe mimata, tranne alcune differenze, ad esempio alcuni metodi possono essere sovrascritti per poter fornire un determinato output utile per i test. Nell’implementare uno stub non è generalmente consentito modificare dettagli di logica interni relativi alla classe che stiamo mimando, ma è possibile sovrascrivere metodi pubblici, in modo che essi ritornino i valori che vogliamo, oppure che svolgano una particolare procedura necessaria per i test. Tanto per fare un esempio pratico potremmo stubbare una classe che ci fornisce la data precisa in un certo istante, in modo da ottenere una data diversa da usare nei test, oppure un client che chiede a un server delle informazioni su un utente, in modo da far ritonare al client stub delle informazioni arbitrarie.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2015-06-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2015-06-05T00:00:00+00:00">


        
            
                <meta property="og:image" content="https://engineering.facile.it/images/social/social-preview.jpg">
            
        

        
  <meta itemprop="name" content="Swift testing avanzato: stubbing e test asincroni">
  <meta itemprop="description" content="In un precedente articolo abbiamo visto le impostazioni di base in Xcode per la scrittura dei test unitari: abbiamo evidenziato inoltre l’importanza e l’utilità intrinseca dei test, attraverso un semplice esempio riguardante un caso d’uso tipico. Nel presente articolo vedremo alcune tecniche un po’ più avanzate:
implementeremo uno Stub Object in Swift; analizzeremo un altro caso di test asincrono; Lo Stub Object Uno Stub Object (per il resto dell’articolo, stub) rappresenta un’istanza di una certa classe, la quale mima una vera classe presente nella nostra code base: l’istanza si comporta esattamente come una equivalente istanza della classe mimata, tranne alcune differenze, ad esempio alcuni metodi possono essere sovrascritti per poter fornire un determinato output utile per i test. Nell’implementare uno stub non è generalmente consentito modificare dettagli di logica interni relativi alla classe che stiamo mimando, ma è possibile sovrascrivere metodi pubblici, in modo che essi ritornino i valori che vogliamo, oppure che svolgano una particolare procedura necessaria per i test. Tanto per fare un esempio pratico potremmo stubbare una classe che ci fornisce la data precisa in un certo istante, in modo da ottenere una data diversa da usare nei test, oppure un client che chiede a un server delle informazioni su un utente, in modo da far ritonare al client stub delle informazioni arbitrarie.">
  <meta itemprop="datePublished" content="2015-06-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2015-06-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1894">
  <meta itemprop="keywords" content="Elviro,Italiano,Swift,Software Testing,Xcode">

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/additional.css">
            <link rel="stylesheet" href="/css/add-on.css">
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/monokai-sublime.min.css' rel='stylesheet' type='text/css' />
  


      
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-1V6DNT10GR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-1V6DNT10GR');
        }
      </script>
    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="/">Facile.it Engineering</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/categories/">
                            <i class="fa fa-folder-open">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="/authors/">
                            <i class="fa fa-pencil">&nbsp;</i>Authors
                    </a>
                </li>
            
                <li>
                    <a href="/ita/careers/">
                            <i class="fa fa-briefcase">&nbsp;</i>Careers
                    </a>
                </li>
            
                <li>
                    <a href="/eng/who-we-are/">
                            <i class="fa fa-users">&nbsp;</i>Who we are
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="https://engineering.facile.it/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="https://engineering.facile.it/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/categories/">
                            <h3>
                                <i class="fa fa-folder-open">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/authors/">
                            <h3>
                                <i class="fa fa-pencil">&nbsp;</i>Authors
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/ita/careers/">
                            <h3>
                                <i class="fa fa-briefcase">&nbsp;</i>Careers
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/eng/who-we-are/">
                            <h3>
                                <i class="fa fa-users">&nbsp;</i>Who we are
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/eng/v-protetto13-9-2024/">Venerdì Protetto | September 2024</a></h3>
                                
                                <time class="published" datetime=
                                    '2024-10-01'>
                                    October 1, 2024</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/eng/v-protetto12-7-2024/">Venerdì Protetto | July edition</a></h3>
                                
                                <time class="published" datetime=
                                    '2024-08-28'>
                                    August 28, 2024</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/eng/v-protetto14-6-2024/">Venerdì Protetto | June edition</a></h3>
                                
                                <time class="published" datetime=
                                    '2024-07-02'>
                                    July 2, 2024</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa-solid fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="//x.com/share?url=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f&amp;text=Swift%20testing%20avanzato%3a%20stubbing%20e%20test%20asincroni&amp;via=FacileIt_Engr" target="_blank" class="share-btn twitter">
    <i class="fa-brands fa-square-x-twitter"></i>
    <p>X</p>
    </a>
</li>





<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f" target="_blank" class="share-btn facebook">
    <i class="fa-brands fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>




<li>
  <a href="//reddit.com/submit?url=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f&amp;title=Swift%20testing%20avanzato%3a%20stubbing%20e%20test%20asincroni" target="_blank" class="share-btn reddit">
    <i class="fa-brand fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f&amp;title=Swift%20testing%20avanzato%3a%20stubbing%20e%20test%20asincroni" target="_blank" class="share-btn linkedin">
      <i class="fa-brand fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>




<li>
  <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f&amp;title=Swift%20testing%20avanzato%3a%20stubbing%20e%20test%20asincroni" target="_blank" class="share-btn stumbleupon">
    <i class="fa-brand fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>




<li>
  <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f&amp;description=Swift%20testing%20avanzato%3a%20stubbing%20e%20test%20asincroni" target="_blank" class="share-btn pinterest">
    <i class="fa-brand fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>




<li>
  <a href="mailto:?subject=Check out this post by &amp;body=https%3a%2f%2fengineering.facile.it%2fblog%2fita%2fswift-testing-avanzato-stubbing-e-test-asincroni%2f" target="_blank" class="share-btn email">
    <i class="fa-solid fa-envelope"></i>
    <p>Email</p>
  </a>
</li>


        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="/blog/ita/swift-testing-avanzato-stubbing-e-test-asincroni/">Swift testing avanzato: stubbing e test asincroni</a></h1>
            
        
        
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2015-06-05'>
            5 June 2015
        </time>

        
            <a href="/authors/elviro/" class="author">
            
                <span class="name">Elviro Rocca</span>
                <img src="https://www.gravatar.com/avatar/fb2983ff4983323312496f2b67e26186?d=404&amp;s=250" alt="Elviro Rocca avatar" />
            
            </a>
        

        
            <p>9 minute read</p>
        
    </div>
</header>


  


  

  <div id="content">
    <p><a href="http://engineering.facile.it/xcode-testing-in-pratica/">In un precedente articolo</a> abbiamo visto le impostazioni di base in Xcode per la scrittura dei <strong>test unitari</strong>: abbiamo evidenziato inoltre <strong>l&rsquo;importanza e l&rsquo;utilità intrinseca dei test</strong>, attraverso un semplice esempio riguardante un caso d&rsquo;uso tipico. Nel presente articolo vedremo alcune tecniche un po&rsquo; più avanzate:</p>
<ul>
<li>implementeremo uno <strong>Stub Object</strong> in Swift;</li>
<li>analizzeremo un altro caso di test <em>asincrono</em>;</li>
</ul>
<h2 id="lo-stub-object">Lo <em>Stub Object</em></h2>
<p>Uno <em>Stub Object</em> (per il resto dell&rsquo;articolo, <em>stub</em>) rappresenta un&rsquo;istanza di una certa classe, la quale <em>mima</em> una vera classe presente nella nostra <em>code base</em>:  l&rsquo;istanza si comporta esattamente come una equivalente istanza della classe mimata, tranne alcune differenze, ad esempio <strong>alcuni metodi possono essere sovrascritti</strong> per poter fornire <strong>un determinato output</strong> utile per i test. Nell&rsquo;implementare uno <em>stub</em> non è generalmente consentito modificare dettagli di logica interni relativi alla classe che stiamo mimando, ma <strong>è possibile sovrascrivere metodi pubblici</strong>, in modo che essi ritornino i valori che vogliamo, oppure che svolgano una particolare procedura necessaria per i test. Tanto per fare un esempio pratico potremmo <em>stubbare</em> una classe che ci fornisce la data precisa in un certo istante, in modo da ottenere una data diversa da usare nei test, oppure un client che chiede a un server delle informazioni su un utente, in modo da far ritonare al client <em>stub</em> delle informazioni arbitrarie.</p>
<p>Gli <em>stub</em> fanno parte di una classe di strumenti che sono usati nell&rsquo;ambito dello <em>Unit Testing</em> per verificare che determinati oggetti rispettino precisi <strong>contratti</strong> stipulati tra essi: il classico articolo di Martin Fowler <a href="http://martinfowler.com/articles/mocksArentStubs.html">Mocks Aren&rsquo;t Stubs</a> è solitamente considerato un buon punto di riferimento per comprendere i possibili strumenti usati a tal scopo. L&rsquo;idea è che, dal punto di vista dei nostri test unitari, un oggetto risulterà essere <em>correttamente implementato</em> se avrà rispettato la sua parte del <em>contratto</em> stipulato con altri oggetti, con la seguente conseguenza:</p>
<blockquote>
<p>se l&rsquo;oggetto A è correttamente implementato e l&rsquo;oggetto B rispetta il contratto stipulato con l&rsquo;oggetto A, allora anche l&rsquo;oggetto B è correttamente implementato</p>
</blockquote>
<p>Gli <em>stub</em> permettono di <strong>disaccoppiare le logiche di funzionamento degli oggetti</strong> perché, se abbiamo verificato il corretto funzionamento dell&rsquo;oggetto A (attraverso appropriati test unitari), possiamo usare uno <em>stub</em> di tale oggetto per verificare il corretto funzionamento dell&rsquo;oggetto B nei suoi confronti, eliminando qualsiasi dipendenza di B nei confronti della logica interna dell&rsquo;oggetto A. L&rsquo;obiettivo è scrivere quindi dei <strong>test veramente unitari</strong> per l&rsquo;oggetto B, anche se questo dipende dall&rsquo;oggetto A. Il classico talk <a href="https://vimeo.com/80533536">Integration Tests are a scam</a> di J.B. Rainsberger fornisce un punto di vista particolarmente &ldquo;radicale&rdquo; sull&rsquo;argomento.</p>
<p>Il classico caso in cui uno <em>stub</em> risulta utile è quello del client che fa una richiesta al server: se la logica di implementazione del server è sotto il nostro controllo possiamo <strong>testare che il server rispetti il contratto con i suoi client</strong> generando degli <em>stub</em> di questi per ogni possibile richiesta; d&rsquo;altra parte, per verificare che i client siano in grado di <strong>gestire correttamente ogni possibile risposta del server</strong>, possiamo generare uno <em>stub</em> del server che fornisca ogni possibile risposta: in questo modo possiamo testare in maniera disaccoppiata client e server.</p>
<h2 id="un-caso-duso-location-services">Un caso d&rsquo;uso: <em>Location Services</em></h2>
<p>Il caso d&rsquo;uso che tratteremo è relativo ai <strong>servizi di localizzazione</strong>, uno strumento frequentemente utilizzato dagli sviluppatori iOS e in generale da chi sviluppa su <strong>smartphone</strong>: per tali sviluppatori, quello dei servizi di localizzazione è un tema molto importante, <strong>fonte di complessità e sfide</strong> che caratterizzano tipicamente il mondo <em>mobile</em>. Non è infatti possibile ottenere l&rsquo;attuale posizione GPS in un preciso momento: l&rsquo;ultima posizione GPS disponibile si basa su una regressione, effettuata dal sistema, dei dati ricevuti da diversi sensori - antenne wifi, cellulare e ovviamente GPS, e spesso anche i sensori di movimento - in diversi momenti; <strong>il sistema può inviare notifiche alla nostra app in qualsiasi momento</strong>, ed essa deve essere in grado di &ldquo;digerire&rdquo; correttamente i dati ricevuti, interpretando anche eventuali errori. Scrivere dei test unitari per verificare che la nostra app geolocalizzata funzioni correttamente può presentare non poche difficoltà: non possiamo infatti affidarci ai &ldquo;veri&rdquo; sensori del dispositivo, perché probabilmente i test verranno eseguiti sul simulatore, oppure magari su un vero iPhone la cui ricezione GPS in un certo istante potrà essere più o meno buona, ma essa rappresenterà un solo caso possibile rispetto a tanti. Vogliamo essere in grado di <strong>testare ogni possibile risposta</strong> del sistema GPS del dispositivo, dall&rsquo;assenza totale di segnale al cambiamento frequente di posizione, alla <strong>mancata autorizzazione</strong> da parte dell&rsquo;utente per l&rsquo;accesso ai servizi di localizzazione.</p>
<p>Supponiamo ad esempio che una certa classe, diciamo un <code>UIViewController</code>, esegua delle <strong>azioni che dipendono dalla posizione ricevuta</strong>. L&rsquo;idea è quella di testare che il nostro <code>UIViewController</code> si comporti &ldquo;bene&rdquo; rispetto alle notifiche del sistema di localizzazione. Il progetto Xcode contenente il codice mostrato in questo articolo è disponibile su <a href="https://github.com/broomburgo/AsyncTestingStubbing">GitHub</a>: si consiglia di scaricare il progetto e tenerlo a riferimento per il resto dell&rsquo;articolo.</p>
<p>Invece di usare direttamente <code>CLLocationManager</code> per ottenere la posizione GPS del dispositivo, implementeremo una semplice classe che fungerà da <em>wrapper</em>, chiamata <code>LocationCoordinator</code>: un&rsquo;istanza di tale classe potrà essere configurata con due semplici funzioni <code>onUpdate</code> e <code>onFailure</code>, in modo da evitare l&rsquo;implementazione dei vari metodi di callback del <code>protocol</code> <code>CLLocationManagerDelegate</code>. L&rsquo;idea è quella di passare un&rsquo;istanza di <code>LocationCoordinator</code> al nostro <code>UIViewController</code>: quest&rsquo;ultimo quindi imposterà le due funzioni di callback indicate sopra, in modo da modificare il suo stato e i dati mostrati all&rsquo;utente.</p>
<p>Di seguito è riportato il codice della classe <code>LocationCoordinator</code>:</p>
<pre tabindex="0"><code>import Foundation
import CoreLocation

public class LocationCoordinator: NSObject {
    
    public let locationManager: CLLocationManager
    
    public override init() {
        locationManager = CLLocationManager()
        super.init()
        locationManager.delegate = self
        locationManager.requestWhenInUseAuthorization()
    }
    
    private var updated: (CLLocation -&gt; ())?
    public func onUpdate(value: CLLocation -&gt; ()) {
        updated = value
    }
    
    private var failed: (NSError -&gt; ())?
    public func onFailure(value: NSError -&gt; ()) {
        failed = value
    }
}

extension LocationCoordinator: CLLocationManagerDelegate {
    
    public func locationManager(manager: CLLocationManager!, didUpdateLocations locations: [AnyObject]!) {
        let location = locations.last as! CLLocation
        if let updated = self.updated {
            updated(location)
        }
    }
    
    public func locationManager(manager: CLLocationManager!, didFailWithError error: NSError!) {
        if let failed = self.failed {
            failed(error)
        }
    }
    
    public func locationManager(manager: CLLocationManager!, didChangeAuthorizationStatus status: CLAuthorizationStatus) {
        switch status {
        case .AuthorizedWhenInUse:
            locationManager.startUpdatingLocation()
        default:
            break
        }
    }
}
</code></pre><p>Come si può vedere, la classe è configurata per richiedere l&rsquo;autorizzazione a leggere la posizione GPS del dispositivo quando l&rsquo;app è in uso, ma non sarà necessario fornire questa autorizzazione per i test: creeremo infatti uno <em>stub</em> che genererà posizioni arbitrarie, senza usare i sensori di sistema. Si ricorda inoltre che usando iOS SDK &gt;= 8.0, per usare i servizi di localizzazione sarà necessario inserire nel file Info.plist una chiave che descrive il motivo per il quale l&rsquo;app chiede l&rsquo;autorizzazione ad accedere a tali servizi:</p>
<p><img src="/images/swift-testing-avanzato-stubbing-e-test-asincroni/locationUsageDescription.png" alt=""></p>
<p>Sebbene l&rsquo;aggiunta della chiave <code>NSLocationWhenIsUseUsageDescription</code> non sia necessaria per eseguire i test, senza questa chiave l&rsquo;app non potrà funzionare in iOS8 nel caso in cui provassimo ad avviarla normalmente.</p>
<p>La classe di cui vogliamo testare il corretto funzionamento è indicata nel progetto con il nome di <code>LocationViewController</code>, e il suo scopo è mostrare le attuali coordinate GPS dell&rsquo;utente o mostrare un messaggio in caso di errore: un sua istanza è, in ogni instante, caratterizzata da un <code>LocationState</code> che rappresenta in quale stato essa si trova rispetto alla ricerca della posizione GPS:</p>
<pre tabindex="0"><code>public enum LocationState {
    case Searching
    case Found
    case Error(CLError)
}
</code></pre><h2 id="implementiamo-i-test">Implementiamo i test</h2>
<p>Per testare la classe verificheremo che, a seconda dei diversi possibili risultati ottenibili dalla ricerca della posizione GPS, un&rsquo;istanza di essa <strong>aggiorni correttamente il suo stato attuale</strong>. È quindi necessario fare in modo che un&rsquo;istanza del <code>LocationCoordinator</code> ignori le notifiche ricevute da <code>CLLocationManager</code>, in modo da forzare posizioni ed errori comodi per i nostri test; per farlo dichiariamo una sottoclasse di <code>LocationCoordinator</code> chiamata <code>STUB_LocationCoordinator</code> che modifichi la <em>parent class</em> nel seguente modo:</p>
<ul>
<li>ignora le notifiche del <code>locationManager</code>:</li>
</ul>
<pre tabindex="0"><code>locationManager.stopUpdatingLocation()
locationManager.delegate = nil
</code></pre><ul>
<li>dichiara 4 funzioni per forzare posizione GPS e/o errori:</li>
</ul>
<pre tabindex="0"><code>forceLocation
forceError
forceRandomDelayedLocations
forceDelayedErrorLocationUnknown
</code></pre><p>Ciascuna di queste funzioni genera le stesse notifiche che normalmente genererebbe <code>CLLocationManager</code>. Le prime due funzioni, <code>forceLocation</code> e <code>forceError</code> forzano immediatamente una certa posizione GPS o un certo errore, mentre la funzione <code>forceRandomDelayedLocations</code> genera una serie di posizioni casuali dopo un certo ritardo e a intervalli regolari, e la funzione <code>forceDelayedErrorLocationUnknown</code> forza un errore del tipo <code>.LocationUnknown</code> dopo un certo ritardo.</p>
<p>Prima di procedere con i test osserviamo che nel file <code>AsyncTestingStubbingTests.swift</code> c&rsquo;è una sezione <em>utility</em> nella quale sono implementate alcune funzioni comode per <strong>rendere  il codice dei test più espressivo</strong>. Ad esempio la funzione <code>mainViewController</code> ritorna l&rsquo;istanza del LocationViewController utilizzata nell&rsquo;interfaccia grafica nell&rsquo;app. Il <em>testing framework</em> integrato in Xcode è chiamato <code>XCTest</code>, e per quanto adeguatamente completo nelle sue funzionalità, esso è principalmente basato su funzioni del tipo <code>XCTAssert</code> che verificano che una qualche condizione sia vera, e se non lo è stampano in console un messaggio di errore passato alla stessa funzione <code>XCTAssert</code> nel momento in cui essa è chiamata: questo può portare alla scrittura di <strong>test verbosi e poco espressivi</strong>. Ci sono diverse librerie facilmente integrabili nei progetti Xcode che semplificano la scrittura dei nostri <em>assert</em>, come ad esempio <a href="https://github.com/Quick/Nimble">Nimble</a>, ma come si può vedere dalle poche funzioni di utility implementate nel progetto associato a questo articolo, basta poco per migliorare consistentemente la leggibilità dei nostri test.</p>
<p>A questo punto possiamo procedere all&rsquo;implementazione dei test. Le funzioni <code>testLocation</code> e <code>testError</code> testano semplicemente che lo stato del <code>mainViewController</code> sia corretto prima e dopo la generazione di una posizione GPS e di un errore arbitrari. Tuttavia questi test non permettono di rappresentare correttamente un caso d&rsquo;uso tipico, perché <strong>le notifiche sulla posizione GPS posso arrivare in qualsiasi momento</strong>, e il <code>LocationViewController</code> deve essere in grado di <em>reagire</em> alle notifiche nel momento in cui queste si presentano. Per simulare la cosa useremo due test <em>asincroni</em>, cioè test il cui risultato non è ottenuto immediatamente, ma dopo un certo tempo: l&rsquo;idea è quella di &ldquo;mettere in pausa&rdquo; i test per un certo numero di secondi, finché non si verifica una certa condizione oppure non scade il tempo: in quest&rsquo;ultimo caso il test verrà considerato <strong>fallito</strong> da <code>XCTest</code> perché la condizione attesa non si è verificata entro il tempo richiesto.</p>
<p>Riportiamo ad esempio il codice della funzione <code>testDelayedLocation</code>:</p>
<pre tabindex="0"><code>func testDelayedLocation() {
        if let vc = mainViewController() {
            let locationExpectation = expectationWithDescription(&#34;locationExpectation&#34;)
            let coordinator = STUB_LocationCoordinator()
            vc.showLocationWithCoordinator(coordinator)
            vc.locationState.assertState(.Searching)
            coordinator.forceRandomDelayedLocations(0.25, times:3)
            after(0.5) {
                vc.locationState.assertState(.Found)
                after(0.25) {
                    vc.locationState.assertState(.Found)
                    locationExpectation.fulfill()
                }
            }
            vc.locationState.assertState(.Searching)
            waitForExpectationsWithTimeout(1, handler: nil)
        }
        else {
            fail(&#34;this will never happen&#34;)
        }
    }
</code></pre><p>La funzione di utility <code>after</code> semplicemente esegue del codice dopo un certo numero di secondi: in base all&rsquo;implementazione di <code>forceRandomDelayedLocations</code> presente in <code>STUB_LocationCoordinator</code>, il <code>LocationViewController</code> dovrebbe  ricevere alcune posizioni GPS a intervalli regolari dopo un certo ritardo, e per verificarlo inseriamo due <em>assert</em>, dopo mezzo secondo e poi ancora un quarto di secondo. Per realizzare il test asincrono  definiamo una <code>XCTestExpectation</code>, quindi una &ldquo;aspettativa&rdquo;, chiamata <code>locationExpectation</code>: in coda al codice di test chiamiamo la funzione <code>waitForExpectationsWithTimeout</code> che fa continuare la funzione di test - senza che essa <em>ritorni</em> - fino alla &ldquo;realizzazione&rdquo; delle aspettative, tenendo conto di un certo tempo di timeout. Quindi, per &ldquo;realizzare&rdquo; un&rsquo;aspettativa, chiamiamo la funzione <code>fulfill</code> su <code>locationExpectation</code>, ma solo dopo aver verificato che lo stato del <code>LocationViewController</code> sia quello corretto.</p>
<p>Possiamo estendere ulteriormente la <em>test suite</em> implementando altri test che simulano ogni tipo di errore possibile, oppure che simulano una situazione in cui posizioni GPS e errori si alternano: una volta compresa la struttura di base per realizzare <em>stub</em> e test asincroni sarà facile migliorare la <a href="http://engineering.facile.it/software-testing-coverage-vs-efficacia/">coverage</a> dei nostri test.</p>

  </div>

  

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa-solid fa-folder"></i>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/italiano">Italiano</a></li>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/swift">Swift</a></li>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/software-testing">Software testing</a></li>
                
                
                <li><a class="article-category-link" href="https://engineering.facile.it/categories/xcode">Xcode</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "facile-it" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="/blog/ita/php-day-2015/"
                class="button big previous">Facile.it devs @ PHP Day 2015</a></li>
    

    
        <li><a href="/blog/ita/continuos-integration-docker-drone/"
                class="button big next">Continuous Integration con Docker e Drone</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='/'><img src="/images/logo_engineering.png" width="100%" alt="Facile.it Engineering" /></a>
      
    
    
      <header>
        <h2></h2>
        <p>News, repos, tips & trends from the Facile.it Engineering team!</p>
      </header>
    
    
      <ul class="icons">
        
          <li>
            <a href="" type="application/rss+xml" target="_blank" title="RSS" class="fa-solid fa-rss"></a>
          </li>
        
        
  <li><a href="//github.com/facile-it" target="_blank" title="GitHub" class="fa-brand fa-github"></a></li>



























  <li><a href="//linkedin.com/company/facile-it" target="_blank" title="LinkedIn Company" class="fa-brand fa-linkedin"></a></li>









  <li><a href="//facebook.com/facile.it" target="_blank" title="Facebook" class="fa-brands fa-facebook-square"></a></li>









  <li><a href="//youtube.com/user/Facileit" target="_blank" title="YouTube" class="fa-brand fa-youtube"></a></li>













  <li><a href="//instagram.com/facile.it" target="_blank" title="Instagram" class="fa-brand fa-instagram"></a></li>





  <li><a href="//x.com/FacileIt_Engr" target="_blank" title="Twitter" class="fa-brand fa-square-x-twitter"></a></li>























      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <div class="author-avatars">
                
                  
                    <a href="/authors/engineering/" class="author" title="See other posts from Facile.it engineers">
                      <img src="https://avatars1.githubusercontent.com/u/8501934?v=3&amp;s=200" alt="Facile.it engineers avatar" class="author-avatar"/>
                    </a>
                  
                
              </div>

              <h3>
                <a href="/blog/eng/v-protetto13-9-2024/">Venerdì Protetto | September 2024</a>
              </h3>
              
              <time class="published" datetime='2024-10-01'>
                1 October 2024
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <div class="author-avatars">
                
                  
                    <a href="/authors/ana-radujko/" class="author" title="See other posts from Ana Radujko">
                      <img src="https://s.gravatar.com/avatar/13c2d19c1d59562ca74b71f5444943c5?s=80" alt="Ana Radujko avatar" class="author-avatar"/>
                    </a>
                  
                
              </div>

              <h3>
                <a href="/blog/eng/v-protetto12-7-2024/">Venerdì Protetto | July edition</a>
              </h3>
              
              <time class="published" datetime='2024-08-28'>
                28 August 2024
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <div class="author-avatars">
                
                  
                    <a href="/authors/engineering/" class="author" title="See other posts from Facile.it engineers">
                      <img src="https://avatars1.githubusercontent.com/u/8501934?v=3&amp;s=200" alt="Facile.it engineers avatar" class="author-avatar"/>
                    </a>
                  
                
              </div>

              <h3>
                <a href="/blog/eng/v-protetto14-6-2024/">Venerdì Protetto | June edition</a>
              </h3>
              
              <time class="published" datetime='2024-07-02'>
                2 July 2024
              </time>
            </header>
            

          </article>
        
      </div>

      
        <a href=
          
            /blog/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="/categories/">Top categories</a></h3>
      </header>
        
          
        

        
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/conferences/">Conferences</a>
                <span style="float:right;">10</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/docker/">Docker</a>
                <span style="float:right;">6</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/english/">English</a>
                <span style="float:right;">41</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/functional-programming/">Functional Programming</a>
                <span style="float:right;">11</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/italiano/">Italiano</a>
                <span style="float:right;">34</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/oop/">OOP</a>
                <span style="float:right;">6</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/open-source/">Open Source</a>
                <span style="float:right;">7</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/php/">PHP</a>
                <span style="float:right;">23</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/protected-fridays/">Protected Fridays</a>
                <span style="float:right;">17</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/software-testing/">Software Testing</a>
                <span style="float:right;">7</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/swift/">Swift</a>
                <span style="float:right;">8</span>
              
            </header>
          </article>
        </p>
        
    
            
        <p>
          <article>
            <header>
              
                <a href="https://engineering.facile.it/categories/symfony/">Symfony</a>
                <span style="float:right;">5</span>
              
            </header>
          </article>
        </p>
        
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
        <p>
            <a href="/categories/" class="button">View more categories</a>
        </p>
    </section>
  
  

  
  
    <section id="mini-bio">
      <h3>About</h3>
      <p>Facile.it relies on a big and keen crew of developers. Since 2008, the group’s projects are based on PHP, and as time goes by new technologies become part of corporate know how. This blog allows our developers to share tips and direct experiences with new technologies.</p>
      <a href="/ita/chi-siamo/" class="button">Learn More</a>
    </section>
  

  
  <section id="footer">
    
      <ul class="icons">
        
          <li>
            <a href="" type="application/rss+xml" target="_blank" title="RSS" class="fa-solid fa-rss"></a>
          </li>
        
        
  <li><a href="//github.com/facile-it" target="_blank" title="GitHub" class="fa-brand fa-github"></a></li>



























  <li><a href="//linkedin.com/company/facile-it" target="_blank" title="LinkedIn Company" class="fa-brand fa-linkedin"></a></li>









  <li><a href="//facebook.com/facile.it" target="_blank" title="Facebook" class="fa-brands fa-facebook-square"></a></li>









  <li><a href="//youtube.com/user/Facileit" target="_blank" title="YouTube" class="fa-brand fa-youtube"></a></li>













  <li><a href="//instagram.com/facile.it" target="_blank" title="Instagram" class="fa-brand fa-instagram"></a></li>





  <li><a href="//x.com/FacileIt_Engr" target="_blank" title="Twitter" class="fa-brand fa-square-x-twitter"></a></li>























      </ul>
    
    <p class="copyright">
      
        &copy; 2024
        
          Facile.it Engineering
        
      .
      <a href="/ita/disclaimer/" rel="nofollow">Disclaimer</a><br>
      Design <a href="http://html5up.net" rel="nofollow" target="_blank">HTML5 UP</a><br>
      Ported by <a href="//github.com/jpescador" rel="nofollow" target="_blank">Julio Pescador</a><br>
      Modified by <a href="//github.com/Jean85" rel="nofollow" target="_blank">Alessandro Lai</a><br>
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa-solid fa-arrow-up fa-border fa-2x"></a>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/dockerfile.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/kotlin.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/objectivec.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/python.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/swift.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
      <script src="/js/backToTop.js"></script>
      <script type="text/javascript" src="/js/jquery-lazy/jquery.lazy.min.js"></script>
    

    

    
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    <script type="text/javascript">
        $(function() {
            $('.lazy').Lazy();
        });
    </script>
  </body>
</html>

